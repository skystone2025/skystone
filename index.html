
<!DOCTYPE html>
<html lang="zh">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <link rel="manifest" href="manifest.json" />
  <title>Sky Stone 投料建议助手</title>
  <style>
    body { font-family: "Microsoft YaHei", sans-serif; padding: 20px; line-height: 1.8; }
    input { font-size: 16px; padding: 5px; margin-bottom: 10px; width: 100%; max-width: 300px; }
    button { font-size: 16px; padding: 10px 20px; margin-top: 10px; }
    .output { margin-top: 20px; border-top: 1px solid #ccc; padding-top: 10px; }
  </style>
</head>
<body>
  <h2>Sky Stone 投料建议助手</h2>
  <label>pH 值：<input id="ph" type="number" step="0.01"></label><br>
  <label>氨氮 NH₃ (mg/L)：<input id="nh3" type="number" step="0.01"></label><br>
  <label>亚硝酸盐 NO₂⁻ (mg/L)：<input id="no2" type="number" step="0.01"></label><br>
  <label>水温 (℃)：<input id="temp" type="number" step="0.1"></label><br>
  <button onclick="generate()">生成投料建议</button>
  <div class="output" id="output"></div>

  <script>
    function formatWeight(value) {
      return value >= 1000 ? (value / 1000).toFixed(1) + " KG" : value + "g";
    }

    function generate() {
      const ph = parseFloat(document.getElementById("ph").value);
      const nh3 = parseFloat(document.getElementById("nh3").value);
      const no2 = parseFloat(document.getElementById("no2").value);
      const temp = parseFloat(document.getElementById("temp").value);
      const now = new Date().toLocaleString("zh-CN", { hour12: false });

      let output = `<strong>【Sky Stone 投料建议】</strong><br>时间：${now}<br><ul>`;
      let risk = false;

      if (ph < 6.5) {
        output += `<li>pH 偏低，建议加小苏打 ${formatWeight(5000)}</li>`;
        risk = true;
      }
      if (nh3 > 2) {
        output += `<li>氨氮 ${nh3} 偏高，建议加糖蜜 ${formatWeight(1500)}，枯草芽孢杆菌 ${formatWeight(200)}</li>`;
        risk = true;
      }
      if (no2 > 1) {
        output += `<li>亚硝酸盐 ${no2} 偏高，建议加维生素C ${formatWeight(100)}</li>`;
        risk = true;
      }
      if (temp >= 33) {
        output += `<li>温度 ${temp}°C 较高，建议加维生素C ${formatWeight(100)} 增强抗应激</li>`;
        risk = true;
      }
      if (risk) {
        output += `<li>存在中度应激风险，建议泼洒食盐 ${formatWeight(5000)} 稀释毒性</li>`;
      }
      if (!risk) {
        output += `<li>水质良好，无需调整</li>`;
      }

      output += "</ul>";
      document.getElementById("output").innerHTML = output;
    }
  </script>
</body>
</html>
